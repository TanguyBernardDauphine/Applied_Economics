---
title: "Untitled"
author: "Margueritte JIN"
date: "2023-05-03"
output: 
  html_document:
      toc: true
      number_sections: true
      css: "style.css"
---
*Nous déclarons sur l'honneur que ce mémoire a été écrit de notre main, sans aide extérieure non autorisée, qu'il n'a pas été présenté auparavant pour évaluation et qu'il n'a jamais été publié, dans sa totalité ou en partie. Toutes parties, groupes de mots ou idées, aussi limités soient- ils, y compris des tableaux, graphiques, cartes etc. qui sont empruntés ou qui font référence à d'autres sources bibliographiques sont présentés comme tels, sans exception aucune.*

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/MG/Desktop/APPLICATION MACRO/")
```

```{r, include=TRUE, message=FALSE}

library(rdbnomics)
library(ggplot2)
library(dplyr)
library(xts)
library(Quandl)
library(readxl)
library(forecast)
```

# .Introduction

Notre devoir s'appuiera sur les données mensuelles entre Janvier 2002 et Avril 2022. 

  **QUESTION 1**
```{r data, include=FALSE}

#Importation des données sur le taux de change entre le dollar et le yen sur la FRED 
dollar_yen <- Quandl('FRED/EXJPUS')

dollar_yen <- dollar_yen[245:2,1:2]
exch_rate <- dollar_yen$Value
exch_rate <- ts(exch_rate,start=c(2002,01),frequency=12, end = c(2022,4))

verif_plot <- ts.plot(exch_rate,
                         ylab="taux de change",xlab="années",
                         col="darkblue",
                         main="Taux de change bilatéral USD (US Dollar) $ - JPY (Japan Yen) ¥")
                title(sub="Données de 2002 à 2022, source:FRED",
                       cex.sub=0.5,font.sub=3,adj=1)
```
   
   
  **QUESTION 2**
  
1. La Parité de Pouvoir d'Achat (PPA)
    

La parité pouvoir d'achat permet de comparer le pouvoir d'achat des devises nationales. Avec cette méthode, ce sont les niveaux généraux des prix des pays qui sont comparés grâce à la constitution de panier de consommations (de biens et de services) de référence. Contrairement au taux de change qui indique la valeur d'une monnaie par rapport à une autre sur les marchés financiers, la PPA  quantifie le coût de la vie, c'est-à-dire la valeur réelle d'une monnaie pour un consommateur. Le calcul de la PPA est indépendant des fluctuations du taux de change sur les marchés financiers. En éliminant l'aspect spéculatif des marchés financiers qui influe sur les taux de change, la PPA reflète une réalité économique.

On obtient le taux de conversion monétaire PPA en faisant le rapport des quantités d’unités monétaires nécessaires dans les différents pays pour se procurer le panier de biens et services de référence :

\[PPA_{absolue} = \frac{\mbox{Prix du panier de biens et services dans le pays domestique}}{\mbox{Prix du panier de biens et services dans le pays étranger}}\]

Par exemple, si le panier de biens et services coûte 100 yen au Japon et 120 dollars aux États-Unis, alors la parité de pouvoir d'achat impliquerait que le taux de change entre le yen et le dollar devrait être de 1,2 dollars pour 1 yen. En d'autres termes, un yen devrait permettre d'acheter autant de biens et services qu'1,2 dollars.

Une autre mesure de la parité de pouvoir d'achat cherche à mesurer l'évolution de ce pouvoir d'achat entre deux pays: la PPA relative. Elle mesure la variation du PPA entre deux périodes.
                 
\[PPA_{relative} = \frac{\mbox{Prix du panier de réf dans le pays dom. à la date t /Prix du panier de réf dans le pays dom. à la date t-1}}{\mbox{Prix du panier de réf dans le pays étr. à la date t/Prix du panier de réf dans le pays étr. à la date t-1}}*100\]

La PPA est sensible aux taux d'inflation. L'évolution des prix influe sur l'évolution de la PPA. Toutes choses égales par ailleurs, si le taux d'inflation aux États-Unis est plus élevé qu'au Japon, alors les prix des biens et services augmenteront plus rapidement aux États-Unis qu'au Japon, ce qui réduira la valeur du dollar en termes de pouvoir d'achat par rapport au yen. (Cela pourrait entraîner une dépréciation du dollar par rapport au yen pour rétablir l'égalité des prix relatifs et maintenir la PPA.)
                 
D'après la théorie de la détermination du taux de change d’équilibre par la PPA, sur le long terme,  une comparaison internationale des monnaies basée sur la parité de pouvoir d’achat permet de définir une ligne directrice pour l’évolution des taux de change. Sur le long terme, les taux de change du marché devraient idéalement se rapprocher des taux de change PPA.

La théorie de la PPA relative suppose quant à elle que le taux de variation du taux de change entre deux pays doit compenser le différentiel d'inflation entre deux pays.
                 
2. La Parité des Taux d'Intérêt Non Couverte (PTINC)        

La parité des taux d’intérêt est une théorie développée par Keynes.
      
La parité des taux d'intérêt non couverte est une théorie qui énonce que les différences entre les taux d'intérêt de deux pays devraient être égales à l'évolution du taux de change anticipée entre les deux devises. En d'autres termes, la variation du taux de change futur devrait compenser la différence de rendement entre les investissements en devise locale et étrangère. Si la théorie est correcte, les investisseurs ne devraient pas être en mesure de réaliser des bénéfices supplémentaires en investissant dans un pays plutôt que dans l'autre, après avoir pris en compte les taux d'intérêt et les taux de change. 

3. Les variables retenues 

Ainsi selon les deux théories vues ci-dessus, on retiendra les variables suivantes: 
 
  - le différentiel d'inflation entre les deux pays pour la PPA 
  
        On prendra le taux de croissance (par rapport à la période précédente) de l'indice des prix à la consommation pour avoir des données mensuelles. Les bases de données ont été tirées de la FRED.
```{r inflation data, include=TRUE}
 #Importation des données CPI du Japon 
inflation_jap_data <- read.csv(file="CPI JAP.csv", header= T, sep=",")

inflation_jap_data <- inflation_jap_data[505:748,1:2]
inflation_jap <- inflation_jap_data$CPALTT01JPM657N

  #Importation des données CPI des États-Unis 
inflation_us_data <- read.csv("CPI USA.csv", header= T, sep=",")
inflation_us_data <- inflation_us_data[505:748,1:2]
inflation_us <- inflation_us_data$CPALTT01USM659N

  #Différenciel des données d'inflation 
diff_inflation <- inflation_us - inflation_jap
diff_inflation_ts <-ts(diff_inflation, start = c(2002,1), end = c(2022,4), frequency=12)

```

 
  - le différentiel de taux d'intérêt pour la PTINC. 
    On choisira la catégorie "Immediate Rates: Less than 24 Hours: Call Money/Interbank Rate" pour avoir une mesure des taux d'intérêt sur le court terme. Les données proviennent également de la FRED. 
    
```{r intérêt data, include=FALSE}
  #Impportation des taux d'intérêt américains 
interet_us_data <- read.csv(file="InteretUS.csv", header= T, sep=",")
interet_us_data <- interet_us_data[1:244,1:2]
interet_us <-interet_us_data$IRSTCI01USM156N

  #Impportation des taux d'intérêt japonais
interet_jap <- read.csv("InteretJAP.csv", header= T, sep=",")
interet_jap <- interet_jap[1:244,1:2]
interet_jap <- interet_jap$IRSTCI01JPM156N

  #Différenciel des raux d'intérêt 
diff_interet <- interet_us - interet_jap
diff_interet_ts <-ts(diff_interet, start = c(2002,1), end = c(2022,4), frequency=12)
```

**Question 3**

Avant d'analyser la corrélation de nos données, il est nécessaire de vérifier la stationnarité de nos variables. Pour se faire, on procède à un examen visuel de nos données. 
```{r autocorr}
#Graphiques des variables exprimées dans le temps
layout(matrix(1:2,2,1))
ts.plot(diff_inflation_ts)
ts.plot(diff_interet_ts) 
ts.plot(exch_rate)
```
Nous avons du mal à discerner clairement si une saisonnalité est présente ou non. On fait alors appel à la fonction Acf du package forecast pour observer l'autocorrélation selon différentes périodes (le lag) de nos séries temporelles.
```{r}
#Autocorrélation pour déceler les saisonnalités 
layout(matrix(1:2,2,1))
Acf(diff_inflation_ts)
Acf(diff_interet_ts)
Acf(exch_rate)
```

Les trois graphiques Acf nous indiquent ainsi une autocorrélation sur plusieurs périodes sur nos trois variables. En effet, les valeurs de l'ACF sortent de la zone de non-significativité d'autocorrélation comprise entre les deux lignes de pointillés bleus. Il va alors falloir corriger la saisonnalité de nos trois variables.

```{r correction }
#POUR DIFF INFLATION 
acf_diff_inflation <-Acf(diff_inflation_ts)
n_lag <- length(acf_diff_inflation$lag)-1
layout(matrix(c(seq(1,n_lag)),ncol=2,nrow=2,byrow=TRUE))
for(cpt in 1:n_lag){
  plot(diff(diff_inflation_ts,lag=cpt))
}

#POUR DIFF INTERET
acf_diff_interet <-Acf(diff_inflation_ts)
n_lag <- length(acf_diff_interet$lag)-1
layout(matrix(c(seq(1,n_lag)),ncol=4,nrow=3,byrow=TRUE))
for(cpt in 1:n_lag){
  plot(diff(diff_interet_ts,lag=cpt))
}

#POUR EXCHANGE RATE
acf_exch_rate <-Acf(exch_rate)
n_lag <- length(acf_exch_rate$lag)-1
layout(matrix(c(seq(1,n_lag)),ncol=4,nrow=3,byrow=TRUE))
for(cpt in 1:n_lag){
  plot(diff(log(exch_rate),lag=cpt))
}

#DONC NOUS CHOISISSONS UN LAG DE 6 AU VU DES GRAPHIQUES CI-DESSUS

exch_rate <- diff(log(exch_rate),lag=6)
diff_interet <- diff(diff_interet_ts,lag=6)
diff_inflation <- diff(diff_inflation_ts,lag=6)

#AFFICHAGE DES GRAPHIQUES
plot(exch_rate)
plot(diff_interet)
plot(diff_inflation)

```

La saisonnalité corrigée, nous pouvons désormais calculer la corrélation entre la différence de taux d'inflation et le taux de change et la corrélation entre la différence de taux d'intérêt et le taux de change. 
```{r corr ppa}
cor(exch_rate,diff_inflation)
```
On calcule tout d'abord le coefficient de corrélation pour le premier modèle, en lien avec la PPA. La variable explicative est le différentiel de taux d'inflation. 

Le coefficient de corrélation linéaire simple pour le première modèle vaut **0.038**. Ce coefficient parait très faible, on peut alors se questionner sur la significativité de $a_{1}$.

```{r corr ptinc}
cor(exch_rate, diff_interet)
```
Le coefficient de corrélation linéaire simple pour le deuxième modèle en lien avec la théorie Parité des taux d'intérêt non couverte vaut **0.29**. Il semble donc y avoir une corrélation positive entre le taux de change et le différentiel de taux d'intérêt, mais qui reste assez faible.

**la moving correlation**

Il nous est ensuite demandé de calculer une corrélation mobile.
La "moving correlation" est une mesure de la corrélation entre deux séries chronologiques qui varie au fil du temps. Contrairement à la corrélation classique, qui mesure la relation linéaire entre deux variables à un moment donné, la moving correlation calcule la corrélation entre les valeurs passées de deux séries chronologiques sur une période donnée, puis glisse cette période dans le temps pour obtenir une série de corrélations mobiles.

La moving correlation peut être utilisée pour examiner comment la relation entre deux variables évolue au fil du temps, et peut aider à identifier les tendances et les changements dans cette relation. 

Nous choisissons ici une fenêtre de 6 mois pour analyser les tendances à court terme dans la relation entre nos variables.

Il est possible de calculer la corrélation mobile à partir de la fonction rollapply() du package zoo.

```{r moving corr ppa}
df <- cbind(exch_rate,diff_inflation)
df <- data.frame(df)

# Calcul de la corrélation mobile entre le taux de change et la différence des taux d'inflation sur une fenêtre de 6 mois 
results <- rollapply(df, width=6, function(x) cor(x[,1],x[,2]), by.column=FALSE)
plot(results, main = "Moving correlation diff.inflation-taux de change")
```
Le nuage de point des corrélations mobiles entre le taux de change et le différentiel de taux de change sur une fenêtre de 6 mois est épars. Cela signifie qu'il n'y a pas de relation claire et stable sur une période de 6mois.

```{r moving corr ptinc}
df <- cbind(exch_rate,diff_interet)
df <- data.frame(df)

# Calcul de la corrélation mobile entre le taux de change et la différence des taux d'inflation sur une fenêtre de 6 mois 
results <- rollapply(df, width=6, function(x) cor(x[,1],x[,2]), by.column=FALSE)
plot(results, main = "Moving correlation diff.inflation-taux de change")
```
    De même pour pour la moving corrélation entre le taux de change et le taux d'intérêt. Il semble difficile d'établir un lien entre les deux variables, sur la fenêtre de 6 mois du moins.
    
    Dans la question suivante, il peut alors être intéressant d'estimer deux modèles selon nos deux théories et étudier leur pertinence. 

#QUESTION 4

## MODÈLE PARITÉ DE POUVOIR D'ACHAT
$$x_{t}=c+\alpha \pi_{us_{t}}-\alpha \pi_{jpn_{t}} + \varepsilon_{t}\\ \Leftrightarrow  x_{t} = c + \alpha (\pi_{us_{t}}-\pi_{jpn_{t}}) +\varepsilon_{t}\\ \Rightarrow x_{t}=c+\alpha \Delta \pi_{t} + \varepsilon_{t}$$
avec : 

- $x_{t}$ : le taux de change USD vers YJPN à la période $t$

- $c$ : la constante de notre modèle

- $\alpha$ : le coefficient

- $\pi_{us_{t}}$ : l'inflation aux États-Unis à la période $t$

- $\pi_{jpn_{t}}$ : l'inflation au Japon à la période $t$

- $\Delta \pi_{t}$ : le différence de taux d'inflation entre $\pi_{us_{t}}$ et $\pi_{jpn_{t}}$ à la date $t$

- $\varepsilon_{t}$ : le terme de l'erreur à l'instant $t$

```{r include=TRUE,message=FALSE}
dates <- seq(as.Date("2002-07-01"), as.Date("2022-04-01"), by= "month")

data_ppp <- xts(data.frame(exch_rate,diff_inflation),order.by = dates)
ggplot(data_ppp,aes(x=diff_inflation,y=exch_rate)) +
  geom_point() +
  ylab("Taux de change USD-JPY")+xlab("Écart taux d'inflations US - JPN") +
  labs(subtitle="Méthode des Moindres Carrés Ordinaires Linéaires")+
  labs(plot.subtitle = element_text(hjust = 0.5,size=10,lineheight = 1))+
  labs(title="Taux de change en fonction de la différence des taux d'inflations",caption="Données mensuelles de 2002 à 2022, source : FRED")+
  theme(plot.title = element_text(hjust = 0.4,size=14))+
  theme(plot.caption=element_text(size=7,face="italic"))+
  geom_smooth(method="lm",formula=y~x,color="darkgreen",level=0)
```
Ce graphique montre une corrélation positive (pente de la tendance  : $\frac{d x_{t}}{d_{\Delta r_{t}}}>0$) entre l'écart du taux d'inflations états-uniens & japonais et le taux de change USD-JPY. Toutefois il faut noter que $\left|\frac{d x_{t}}{d_{\Delta r_{t}}}\right|<1$, et donc la corrélation est faible, ce qui nous permet pas d'affirmer que la différences entre taux d'inflations états-unien et japonais explique significativement le taux de change USD-JPY. Nous estimons notre modèle PPP à l'aide des moindres carrés ordinaires et ensuite réalisons un test de Fisher afin de déterminer la significativé globale du modèle.

```{r}
estim_ppp <- lm(exch_rate~diff_inflation)
summary(estim_ppp)
```

Ainsi après estimation, $x_{t}=c+\alpha \Delta \pi_{t} + \varepsilon_{t}\\ \Leftrightarrow x_{t}= -0.002825+0.001705\Delta \hat{\pi_{t}} + \epsilon_{t}$

La détermination de la significativité globale à l'aide d'un test de Fisher du tableau d'analyse de la variance.

- Hypothèses :
$$\left\{ \begin{array}{cl}
H_{0} & : \ SCE = 0 \\
H_{1} & : \ SCE ≠ 0
\end{array} \right. \Leftrightarrow \left\{ \begin{array}{cl}
H_{0} & : \ \alpha = 0 \\
H_{1} & : \ \alpha ≠ 0
\end{array} \right.$$

- Statistique du test :
$$F^{*}=\frac{SCE/ddl_{SCE}}{SCR/ddl_{SCR}}=\frac{R^{2}/1}{R^{2}/(n-2)}\sim F(1,n-2)$$
Avec ici $n$ notre nombre d'observations. Or l'on sait d'après les résultats précédents $n=244$, de plus $R^{2} =   0.001456$ d'après la sortie précédente.
Donc $F^{*}=\frac{R^{2}/1}{R^{2}/(n-2)}=\frac{ 0.001456}{ 0.001456/(238-2)}=0.3441\sim F(1,236)$. Ici on retrouve bien la statistique de Fisher de la sortie précédente : $F^{*}=0.3441$

- Régle de décision : nous comparons $F^{*}$ à la valeur lue dans la table de Fisher à $(1,236) \ ddl$ au seuil de $\theta=5\%$, nous pouvons également éxécuter la commande `qf(0.95,1,236)` pour trouver le quantile. Ainsi $F^{\theta/2}_{(1,n-2)}=F^{0.025}_{1,236}=3.88$. Ainsi $F^{*}<3.881163$, donc nous ne rejettons pas $H_{0}$ au seuil de $\theta = 5\%$, donc notre modèle PPP n'est pas globalement significatif.



```{r}
ggplot(data_ppp,aes(x=dates))+
  geom_line(aes(y = exch_rate), color = "darkgreen") + 
  geom_line(aes(y = diff_inflation), color="lightgreen")+
  ylab("Taux")+xlab("Temps")+
  labs(title="Évolution du taux de change et de l'écart des taux d'inflations",caption="Données mensuelles de 2002 à 2022, source : FRED")+
  theme(plot.title = element_text(hjust = 0.4,size=14))+
  theme(plot.caption=element_text(size=7,face="italic"))+
   scale_color_manual(values=c("darkgreen","lightgreen"), 
                     name=c("Taux de change USD-JPY","Écart entre taux d'inflations US et JPN"))
  
  
```

## MODÈLE PARITÉ DE TAUX D'INTRÉRÊT NON COUVERT
$$x_{t}=c+\alpha r_{us_{t}} -\alpha r_{jpn_{t}} + \varepsilon_{t} \Leftrightarrow x_{t} = c + \alpha(r_{us_{t}}-r_{jpn_{t}}) +\varepsilon_{t} \\ \Rightarrow x_{t}=c+\alpha \Delta r_{t}$$
avec : 

- $x_{t}$ : le taux de change USD vers YJPN à la période $t$,

- $c$ : la constante de notre modèle,

- $\alpha$ : le coefficient,

- $r_{us_{t}}$ : le taux d'intérêt aux États-Unis à la période $t$,

- $r_{jpn_{t}}$ : le taux d'intérêt au Japon à la date $t$,

- $\Delta r_{t}$ : la différence entre le taux d'intérêt aux États-Unis ($r_{us_{t}}$) et le taux d'intérêt au Japon ($r_{jpn_{t}}$).

Une première méthode d'observer si la variable exogène : l'écart entre les taux d'intérêts états-unien et japonais explique la variable endogène : le taux de change USD-JPY de notre modèle UIRP est de réaliser un graphique comportant les deux séries temporelles. Et ensuite nous observerons si les deux variables suivent les mêmes variations.

```{r}
data_uirp <- xts(data.frame(exch_rate,diff_interet),order.by = dates)
ggplot(data_uirp,aes(x=dates))+
  geom_line(aes(y = exch_rate), color = "darkgreen") + 
  geom_line(aes(y = diff_interet), color="lightgreen")+
  ylab("Taux")+xlab("Temps")+
  labs(title="Évolution du taux de change et de l'écart des taux d'intérêts",caption="Données mensuelles de 2002 à 2022, source : FRED")+
  theme(plot.title = element_text(hjust = 0.4,size=14))+
  theme(plot.caption=element_text(size=7,face="italic"))+
  scale_color_manual(values=c("darkgreen","lightgreen"), 
                     name=c("Taux de change USD-JPY","Écart entre taux d'intérêts US et JPN"))
  
```

Avec ce graphique, il est difficile d'observer une possible influence des taux d'intérêts sur le taux de change USD-JPY. Cela est du au fait que les deux variables sont sur des échelles très différentes. Une seconde méthode est de faire un graphique représentant le taux de change USD-JPY en fonction de l'écart entre taux d'intérêts états-unien et japonais et de tracer une courbe de tendance.

```{r include=TRUE,message=FALSE}
data_uirp <- xts(data.frame(exch_rate,diff_interet),order.by = dates)
ggplot(data_uirp,aes(x=diff_interet,y=exch_rate)) +
  geom_point() +
  ylab("Taux de change USD-JPY")+xlab("Écart taux d'intérêts US et JPN") +
  labs(subtitle="Méthode des Moindres Carrés Ordinaires Linéaires")+
  labs(plot.subtitle = element_text(hjust = 0.5,size=10,lineheight = 1))+
  labs(title="Taux de change en fonction de la différence des taux d'intérêts",caption="Données mensuelles de 2002 à 2022, source : FRED")+
  theme(plot.title = element_text(hjust = 0.4,size=14))+
  theme(plot.caption=element_text(size=7,face="italic"))+
  geom_smooth(method="lm",formula=y~x,color="darkgreen",level=0)
```
Ce graphique montre l'existence d'une corrélation négative (pente de la tendance $\frac{d x_{t}}{d_{\Delta r_{t}}}<0$) entre l'écart des taux d'inflations états-uniens & japonais et le taux de change USD-JPY. Néanmoins $\left|\frac{d x_{t}}{d_{\Delta r_{t}}}\right|<1$, ce qui montre qu'indique que le niveau de corrélation n'est pas pour autant élevé.
Nous estimons notre modèle avec les moindres carrés ordinaires, et réalisons ensuite un test de Fisher du tableau d'analyse de la variance afin de savoir si le modèle UIRP est globalement significatif.


```{r}
estim_uirp <- lm(exch_rate~diff_interet)
summary(estim_uirp)
```
Ainsi d'après les résultats de notre estimation, $x_{t}=c+\alpha \Delta r_{t} + \varepsilon_{t}\\ \Leftrightarrow x_{t}= -0.0014- 0.03 \Delta \hat{r_{t}} + \varepsilon_{t}$

Nous cherchons maintenant si notre modèle UIRP est globalement significatif en utilisant un test de Fisher du tableau d'analyse de la variance.

- Hypothèses :
$$\left\{ \begin{array}{cl}
H_{0} & : \ SCE = 0 \\
H_{1} & : \ SCE ≠ 0
\end{array} \right. \Leftrightarrow \left\{ \begin{array}{cl}
H_{0} & : \ \alpha = 0 \\
H_{1} & : \ \alpha ≠ 0
\end{array} \right.$$

- Statistique du test :
$$F^{*}=\frac{SCE/ddl_{SCE}}{SCR/ddl_{SCR}}=\frac{R^{2}/1}{R^{2}/(n-2)}\sim F(1,n-2)$$
Avec $n$ notre nombre d'observations. De plus nous savons que $n=238$, de plus $R^{2} =  0.08275$ d'après la sortie précédente.
Donc $F^{*}=\frac{R^{2}/1}{R^{2}/(n-2)}=\frac{0.08275}{0.08275/(238-2)}=21.29\sim F(1,236)$, ce qui est corrobore la  statistique de Fisher de la sortie précédente : $F^{*}=21.29$

- Régle de décision : nous comparons $F^{*}$ à la valeur lue dans la table de Fisher à $(1,236) \ ddl$ au seuil de $\theta=5\%$. Nous savons déà grâce au test précédent que $F^{\theta/2}_{(1,n-2)}=F^{0.025}_{1,236}=3.881163$.
De fait $F^{*}>3.88$, nous rejettons à nouveau $H_{0}$. Ce modèle semble également globalement significatif.

Nous retenons finalement le modèle UIRP qui contrairement au modèle PPP est globalement significatif.


**Question 5**

Pour pallier la faible croissance de l'économie japonaise persistante depuis 1990, le premier ministre Shinzo Abe a décidé de lancer une série de politiques économiques: les Abenomics. Les Abenomics, dont l'objectif est de relancer l'économie japonaise, débutent en 2013 et sont divisées en trois piliers principaux : une relance budgétaire, une politique monétaire accomodante et des réformes structurelles. Même après la démission de Shinzo Abe en 2020, ces politiques ont perduré en laissant son nom pour celui de Suganomics (du nom du nouveau Premier ministre). On se demande alors si l'instauration de ces politiques économiques expansionniste (de 2013 jusqu'à aujourdhui) auront un impact dans l'explication de la variation du taux de change. 
Notre variable binaire se définit alors comme suit: 

$$
Indic_{1}= \left\{
    \begin{array}{ll}
        1 & \mbox{si politiques Abenomics}\\
        0 & \mbox{sinon.}
    \end{array}
\right.
$$
On crée notre variable indicatrice, qui prend 1 pour toutes les dates après 2012. 
```{r}
Indic1 <- matrix(nrow=238)
ligne <- 1
  for (annee in 2002:2022){
    for (mois in 1:12){
      if (annee<2012){
        Indic1[ligne] <- 0
      }else{
        Indic1[ligne] <- 1
      }
      ligne <- ligne+1
    }
  }
Indic1 <- Indic1[7:244]
Indic1 <- data.frame(Indic1, dates)
```

On estime notre nouveau modèle avec notre première variable indicatrice.

```{r}
modelIndic1 <- lm(exch_rate~ diff_interet+Indic1[,1])
summary(modelIndic1)
```

Tout d'abord, nous comparons la t-value de la variable Indic1 à la valeur dans la table de Student $t^{0,05}_{n-k-1=235}=1,96$. $t_{\beta}=5,72 > 1,96$. Nous pouvons donc conclure à la significativité de la variable $Indic_1$ au seuil de 5%. 
De même, la variable diff_interet reste significative.
Par ailleurs, nous avons un $R^2$ ajusté qui a augmenté, passant de 0,079 à 0,188. Nous pouvons alors statuer que le modèle s'est amélioré.
Nous voyons que l'ajout de notre première variable indicatrice améliore notre modèle. 

Nous retenons alors le modèle suivant: 

 $x_{t}=c+\alpha \Delta r_{t} + \beta Indic_{1,t} + \varepsilon_{t} \\ \Leftrightarrow x_{t} \simeq -0.025 +0.027 \Delta r_{t} + 0.044 Indic_{1,t} + \varepsilon_{t}$



On peut également se demander si l'arrivée de Donald Trump à la présidence des États-Unis a eu un impact sur les taux de change. Les politiques de l'administration Trump à l'égard de l'extérieur se démarquent des précédentes, du moins celles d'Obama. Ainsi, on cherche à voir si l'effet Trump joue sur les taux de change.
Bien que le début de son mandat ait eu lieu en janvier 2017, on suppose que dès son élection (8 novembre 2016), les anticipations des agents se forment et prennent effet. Sur le même principe, on suppose que dès l'election de Joe Biden (3 novembre 2022), les anticipations se forment et l'effet Trump prend fin. 

Notre deuxième variable binaire se définit alors comme suit: 

$$
Indic_{2}= \left\{
    \begin{array}{ll}
        1 & \mbox{si Trump "au pouvoir"}\\
        0 & \mbox{sinon.}
    \end{array}
\right.
$$
On crée notre deuxième indicatrice qui prendra la valeur 1 entre décembre 2016 et décembre 2020. 
```{r}
Indic2 <- matrix(nrow=238)
ligne <- 1
  for (annee in 2002:2022){
    for (mois in 1:12){
      if ((annee>2016 & annee <2021)){
        Indic2[ligne] <- 1
      }else{
        Indic2[ligne] <- 0
      }
      if (annee==2016 & mois==12){
        Indic2[ligne] <- 1
      }
      ligne <- ligne+1
    } 
  }
Indic2 <- Indic2[1:238]
Indic2 <- data.frame(Indic2, dates)
```
  On estime de nouveau un modèle avec notre deuxième variable indicatrice.
  
```{r}
modelIndic2 <- lm(exch_rate~ diff_interet+Indic1[,1]+Indic2[,1])
summary(modelIndic2)
```
De même, tous les coefficients sont significatifs. Car toutes les t-values (en valeur absolue) sont supérieures à 1,96. Le $R^2$ a également augmenté, passant de 0,188 à 0,228. Nous pouvons alors dire que la variable $Indic_2$ améliore également l'estimation de notre modèle. 

Notre modèle devient alors: 

 $x_{t}=c+\alpha \Delta r_{t} + \beta Indic_{1,t} + \gamma Indic_{2,t}+ \varepsilon_{t} \\ \Leftrightarrow x_{t} \simeq -0.025 +0.025 \Delta r_{t} + 0.06 Indic_{1,t} + -0.04Indic_{2,t}+   \varepsilon_{t}$
  
  
**Question 6**

Pour tenter d'améliorer la significativité de notre modèle, on ajoute des variables explicatives supplémentaires.

La balance des paiements permet de renseigner sur les transactions et donc les flux de devises entre un pays et le reste du monde. La balance des paiements mesure les transactions économiques entre un pays et le reste du monde au cours d'une période donnée. Elle comprend aussi bien les échanges commerciaux de biens et services que les échanges financiers. Une variation de la balance des paiements influence l'offre et la demande de la monnaie sur le marché des changes.  Ainsi on s'interroge si les balances des paiements des États-Unis ($BOP_{US}$) et du Japon($BOP_{JP}$) permettront d'améliorer notre estimation. Nous testons donc l'ajout de deux variables et nous sélectionnerons notre modèle optimal par la méthode de "Backward elimination".

Les données de la balance des paiements américaines viennent du bureau du recensement du gouvernement américain (United States Census Bureau). Celles du Japon ont été téléchargées sur le site du ministère japonais des finances . 



```{r}
#Importation des données balance des paiements du Japon 
bop_jpn <- read_excel("BOP JAP 2.xlsx")
bop_jpn <- bop_jpn$BOP
bop_jpn <- bop_jpn[79:316] #Nous sélectionnons les valeurs entre juillet 2002 et avril 2022
bop_jpn <- ts(data=bop_jpn,start=c(2002,07),end=c(2022,04),frequency=12)

#Importation des données balance des paiements des États-Unis
bop_us <- read_excel("BOP US.xlsx")
bop_us <- bop_us$BOP
bop_us <- bop_us[127:364]
bop_us <- ts(data=bop_us,start=c(2002,07),end=c(2022,04),frequency=12)

variables <- cbind(diff_interet,Indic1[,1],Indic2[,1], bop_us,bop_jpn)
```
On estime d'abord notre modèle complet composé de toutes nos variables:  $x_{t}=c+\alpha \Delta r_{t} + \beta Indic_{1,t} + \gamma Indic_{2,t}+ \zeta BOP_{US,t}+ \eta BOP_{JP,t} + \varepsilon_{t} $
```{r}
model4 <- lm(exch_rate~ variables)
summary(model4)
```
En observant les t-values, nous voyons que la variable liée à la balance des paiements japonaise n'est pas significative. En effet sa t-value est inférieure à 1,96. On élimine donc cette variable puis on réestime notre modèle 
```{r}
variables <- cbind(diff_interet,Indic1[,1],Indic2[,1], bop_us)
model5 <- lm(exch_rate~ variables)
summary(model5)
```
Le modèle composé des variables Diff_intérêt, $Indic_1$, $Indic_2$ et $BOP_{US}$ sont toutes significatives. Leurs t-values (en valeur absolue) sont toutes supérieures à $t^{0,05}_{n-k-1=235}=1,96$. Nous conservons alors ce modèle. D'après l'estimation nous avons: 

$x_{t}=c+\alpha \Delta r_{t} + \beta Indic_{1,t} + \gamma Indic_{2,t}+ \zeta BOP_{US,t}+ \varepsilon_{t} \\ \Leftrightarrow x_{t} \simeq =7.345e^{-02}+2.452e^{-02} \Delta r_{t} + 6.389e^{-02} Indic_{1,t} -4.401e^{-02} Indic_{2,t} -9.748e^{-07}  BOP_{US,t}+ \varepsilon_{t}$$

Avec l'ajout de la variable de la balance des paiements américaine, le $R^2$ ajusté a légèrement augmenté, passant de 0,228 à 0,256. La balance des paiements japonaises, quant à elle, n'était pas significative. On pourrait supposer que dans le taux de change Yen-Dollar les valeurs des échanges japonaises sont trop faibles, comparativement à celles des États-Unis, pour pouvoir influencer le taux de change. 

**Question 7**
Pour cette question, il nous est demandé de comparer la significativité et les estimations des coefficients à travers différentes périodes. 
On découpe nos dates selon les justifications comme suit: 

 - 2002 à 2006: répercussions de la crise asiatique + bulle spéculative japonaise 
 - 2007 à 2012: crise des subprimes 
 - 2013 à 2019: début des Abenomics en 2013 + États-Unis deviennent exportateurs nets en gaz naturel en 2013
 - 2020 à 2021: crise Covid-19 

```{r}
data <- xts(data.frame(exch_rate,diff_interet,Indic1[,1],Indic2[,1], bop_us),order.by=dates)
var_1 <- window(data,start=as.Date("2002-01-01"),end=as.Date("2006-12-01"))
var_2 <- window(data,start=as.Date("2007-01-01"),end=as.Date("2012-12-01"))
var_3 <- window(data,start=as.Date("2013-01-01"),end=as.Date("2019-12-01"))
var_4 <- window(data,start=as.Date("2020-01-01"),end=as.Date("2022-04-01"))
```
On régresse selon chaque période
```{r}
model_2002_2006 <- lm(var_1[,1]~ var_1[,2:5])
summary(model_2002_2006) #NA pour les Indic 1 et 2 car composées que de 0 

model_2007_2012 <- lm(var_2[,1]~ var_2[,2:5])
summary(model_2007_2012) #same shit NA pour indic 2 car composée que de 0 

model_2013_2019 <- lm(var_3[,1]~ var_3[,2:5])
summary(model_2013_2019) #cette fois que des 1 pour la variable Indic1 

model_2020_2022 <- lm(var_4[,1]~ var_4[,2:5])
summary(model_2020_2022) #
```

Afin d'observer le degré de stabilité de notre modèle selon les périodes, nous réalisons un test de Chow.


```{r}
residu <- model5$residual
scr_c <- sum(residu^2)
```

# .Présentation des modèles de la dynamique du taux de change
# .Vérification empirique des variables exogènes des modèles
# .Test d'ajout de variables exogènes (non basées sur les modèles)
# .Sources 
  https://www.banqueducanada.ca/wp-content/uploads/2010/06/lafrance.pdf
  https://www.tresor.economie.gouv.fr/Articles/1948e940-a0e7-46de-8f3e-1d0722001eb3/files/541c735f-a5be-4568-ab70-062aec89cfa5
  https://pmarchand1.github.io/ECL8202/notes_cours/11-Series_temporelles.pdf




